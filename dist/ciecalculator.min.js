!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.CIECalculator=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){"use strict";var CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg00=function(){};Alg00.prototype=new CIEStrategy,Alg00.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:19}}};if(!cieUtils.validateInput(input,validationRules)){var error=new Error("Longitud invalida");throw error.status="422",error}for(var acc=0,tmpInput=input.reference.split("").reverse().join(""),i=0;i<input.reference.length;i++)acc+=cieUtils.sequentialAdd(parseInt(tmpInput[i],10)*((i+1)%2!==0?2:1));return input.reference+(cieUtils.nearestMultipleOf(acc,10)-acc)%10}},module.exports.Alg00=Alg00},{"./cie_strategy.js":12,"./cie_utils.js":13}],2:[function(require,module){"use strict";var CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg02=function(){};Alg02.prototype=new CIEStrategy,Alg02.prototype={execute:function(input){var validationRules={reference:{length:{min:6,max:19}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");for(var acc=0,reference=parseInput(input),i=0;i<reference.length;i++)acc+=cieUtils.sequentialAdd(parseInt(reference[i],10)*((i+1)%2!==0?1:2));return input.reference.toUpperCase()+(cieUtils.nearestMultipleOf(acc,10)-acc)%10}},module.exports.Alg02=Alg02;var parseInput=function(input){var charToNum={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:0};return cieUtils.replaceCharWithNum(input.reference.toUpperCase(),charToNum)}},{"./cie_strategy.js":12,"./cie_utils.js":13}],3:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg03=function(){};Alg03.prototype=new CIEStrategy,Alg03.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:19}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");for(var acc=0,reference=parseInput(input),i=0;i<reference.length;i++)acc+=parseInt(reference[i],10)*(i+2);return input.reference+(7-acc%7)}},module.exports.Alg03=Alg03;var parseInput=function(input){return _.last(input.reference,6).reverse()}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],4:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg04=function(){};Alg04.prototype=new CIEStrategy,Alg04.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:18}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var reference=parseInput(input),acc=cieUtils.weightedReduce(reference,[11,13,17,19,23])-11*reference[0];return input.reference+((acc+330)%97+1)}},module.exports.Alg04=Alg04;var parseInput=function(input){return _.toArray(input.reference).reverse()}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],5:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg06=function(){};Alg06.prototype=new CIEStrategy,Alg06.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:18}},branch:{length:{min:1,max:8}},account:{length:{min:1,max:8}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var reference=parseInput(input),acc=cieUtils.weightedReduce(reference,[37,31,29,23,19,17,13,11]);return input.reference+(99-acc%97)}},module.exports.Alg06=Alg06;var parseInput=function(input){var paddedBranch=_.toArray(cieUtils.pad(input.branch,8)),paddedAccount=_.toArray(cieUtils.pad(input.account,8)),paddedReference=_.last(cieUtils.pad(input.reference,8),8);return paddedBranch.concat(paddedAccount,paddedReference).reverse()}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],6:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg10=function(){};Alg10.prototype=new CIEStrategy,Alg10.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:12}},date:{length:{min:8,max:8}},amount:{length:{min:1,max:12}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var condensedInput=parseInput(input),acc=cieUtils.weightedReduce(condensedInput.reference,[11,13,17,19,23]);return input.reference+condensedInput.date+condensedInput.amount+"2"+(acc%97+1)}},module.exports.Alg10=Alg10;var parseInput=function(input){var paddedDate=cieUtils.pad(372*(input.date.substr(4,4)-2014)+31*(input.date.substr(2,2)-1)+(input.date.substr(0,2)-1),4),paddedAmount=cieUtils.weightedReduce(_.without(_.toArray(input.amount),".").reverse(),[7,3,1])%10;return{reference:_.toArray(input.reference+paddedDate+paddedAmount+"2").reverse(),amount:paddedAmount,date:paddedDate}}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],7:[function(require,module){"use strict";var CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg35=function(){};Alg35.prototype=new CIEStrategy,Alg35.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:19}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var acc=cieUtils.sequentialWeightedReduce(parseInput(input),[4,3,8]);return input.reference.toUpperCase()+(cieUtils.nearestMultipleOf(acc,10)-acc)%10}},module.exports.Alg35=Alg35;var parseInput=function(input){var charToNum={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:10,K:11,L:12,M:13,N:14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:24,Y:25,Z:26,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:0};return cieUtils.replaceCharWithNum(input.reference.toUpperCase(),charToNum)}},{"./cie_strategy.js":12,"./cie_utils.js":13}],8:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg36=function(){};Alg36.prototype=new CIEStrategy,Alg36.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:19}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var acc=cieUtils.sequentialWeightedReduce(parseInput(input),[2,1]);return input.reference.toUpperCase()+(cieUtils.nearestMultipleOf(acc,10)-acc)%10}},module.exports.Alg36=Alg36;var parseInput=function(input){var charToNum={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:0};return _.toArray(cieUtils.replaceCharWithNum(input.reference.toUpperCase(),charToNum)).reverse()}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],9:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg37=function(){};Alg37.prototype=new CIEStrategy,Alg37.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:19}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var reference=parseInput(input),acc=cieUtils.weightedReduce(reference,[11,13,17,19,23]);return input.reference.toUpperCase()+cieUtils.pad((acc+330-11*reference[0])%97+1,2)}},module.exports.Alg37=Alg37;var parseInput=function(input){var charToNum={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:0};return _.toArray(cieUtils.replaceCharWithNum(input.reference.toUpperCase(),charToNum)).reverse()}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],10:[function(require,module){"use strict";var _=require("underscore"),CIEStrategy=require("./cie_strategy.js").CIEStrategy,CIEUtils=require("./cie_utils.js").CIEUtils,cieUtils=new CIEUtils,Alg77=function(){};Alg77.prototype=new CIEStrategy,Alg77.prototype={execute:function(input){var validationRules={reference:{length:{min:1,max:12}},date:{length:{min:8,max:8}},amount:{length:{min:1,max:12}}};if(!cieUtils.validateInput(input,validationRules))throw new Error("Longitud invalida");var condensedInput=parseInput(input),acc=cieUtils.weightedReduce(condensedInput.reference,[11,13,17,19,23]);return input.reference+condensedInput.date+condensedInput.amount+"2"+(acc%97+1)}},module.exports.Alg77=Alg77;var parseInput=function(input){var paddedDate=cieUtils.pad(372*(input.date.substr(4,4)-2013)+31*(input.date.substr(2,2)-1)+(input.date.substr(0,2)-1),4),paddedAmount=cieUtils.weightedReduce(_.without(_.toArray(input.amount),".").reverse(),[7,3,1])%10;return{reference:_.toArray(input.reference+paddedDate+paddedAmount+"2").reverse(),amount:paddedAmount,date:paddedDate}}},{"./cie_strategy.js":12,"./cie_utils.js":13,underscore:15}],11:[function(require,module){"use strict";var CIECalculator=function(){this.strategy=""};CIECalculator.prototype={setStrategy:function(strategy){this.strategy=strategy},execute:function(reference){return this.strategy.execute(reference)}},module.exports.CIECalculator=CIECalculator},{}],12:[function(require,module){"use strict";var CIEStrategy=function(){};CIEStrategy.prototype={execute:function(){throw new Error("CIEStrategy#execute needs to be overridden.")}},module.exports.CIEStrategy=CIEStrategy},{}],13:[function(require,module){"use strict";var _=require("underscore"),CIEUtils=function(){};CIEUtils.prototype={nearestMultipleOf:function(val,base){return(Math.floor(val/base)+1)*base},sequentialAdd:function(input){return _.reduce(input.toString(),function(memo,num){return memo+parseInt(num)},0)},replaceCharWithNum:function(input,charToNum){return _.map(input,function(x){return charToNum[x]})},pad:function(n,width,z){return z=z||"0",n+="",n.length>=width?n:new Array(width-n.length+1).join(z)+n},validateLength:function(field,min,max){return field.length>=min&&field.length<=max},weightedReduce:function(input,weights,debug){for(var acc=0,i=0;i<input.length;i++)debug&&console.log("input: "+input[i]+" w: "+weights[i%weights.length]+" = "+parseInt(input[i]*weights[i%weights.length])),acc+=parseInt(input[i]*weights[i%weights.length]);return acc},sequentialWeightedReduce:function(input,weights,debug){for(var acc=0,i=0;i<input.length;i++){debug&&console.log("input: "+input[i]+" w: "+weights[i%weights.length]+" = "+CIEUtils.prototype.sequentialAdd(parseInt(input[i]*weights[i%weights.length])));for(var tmp=CIEUtils.prototype.sequentialAdd(parseInt(input[i]*weights[i%weights.length]));1!==tmp.toString().length;)tmp=CIEUtils.prototype.sequentialAdd(tmp);acc+=tmp}return acc},validateInput:function(input,validationRules){var validateLengths=function(input,validationRules){return _.reduce(_.keys(validationRules),function(memo,k){return memo&&CIEUtils.prototype.validateLength(input[k],validationRules[k].length.min,validationRules[k].length.max)},!0)};return validateLengths(input,validationRules)}},module.exports.CIEUtils=CIEUtils},{underscore:15}],14:[function(require,module,exports){"use strict";var CIECalculator=require("./lib/strategies/cie_calculator.js").CIECalculator,Alg00=require("./lib/strategies/alg00.js").Alg00,Alg02=require("./lib/strategies/alg02.js").Alg02,Alg03=require("./lib/strategies/alg03.js").Alg03,Alg04=require("./lib/strategies/alg04.js").Alg04,Alg06=require("./lib/strategies/alg06.js").Alg06,Alg10=require("./lib/strategies/alg10.js").Alg10,Alg35=require("./lib/strategies/alg35.js").Alg35,Alg36=require("./lib/strategies/alg36.js").Alg36,Alg37=require("./lib/strategies/alg37.js").Alg37,Alg77=require("./lib/strategies/alg77.js").Alg77;module.exports=function(params){var calculator=new CIECalculator;return calculator.setStrategy(eval("new Alg"+params.alg+"()")),calculator.execute(params)}},{"./lib/strategies/alg00.js":1,"./lib/strategies/alg02.js":2,"./lib/strategies/alg03.js":3,"./lib/strategies/alg04.js":4,"./lib/strategies/alg06.js":5,"./lib/strategies/alg10.js":6,"./lib/strategies/alg35.js":7,"./lib/strategies/alg36.js":8,"./lib/strategies/alg37.js":9,"./lib/strategies/alg77.js":10,"./lib/strategies/cie_calculator.js":11}],15:[function(require,module,exports){(function(){var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?createCallback(value,context,argCount):_.isObject(value)?_.matches(value):_.property(value)},_.each=_.forEach=function(obj,iteratee,context){if(null==obj)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length)for(i=0;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){if(null==obj)return[];iteratee=_.iteratee(iteratee,context);for(var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;length>index;index++)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.reduceRight=_.foldr=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}for(;index--;)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.find=_.detect=function(obj,predicate,context){var result;return predicate=_.iteratee(predicate,context),_.some(obj,function(value,index,list){return predicate(value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(predicate=_.iteratee(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)},_.every=_.all=function(obj,predicate,context){if(null==obj)return!0;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){if(null==obj)return!1;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.include=function(obj,target){return null==obj?!1:(obj.length!==+obj.length&&(obj=_.values(obj)),_.indexOf(obj,target)>=0)},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||1/0===computed&&1/0===result)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=obj&&obj.length===+obj.length?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=_.iteratee(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;length>i;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=_.iteratee(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i];if(isSorted)i&&seen===value||result.push(value),seen=value;else if(iteratee){var computed=iteratee(value,i,array);_.indexOf(seen,computed)<0&&(seen.push(computed),result.push(value))}else _.indexOf(result,value)<0&&result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(array){if(null==array)return[];for(var length=_.max(arguments,"length").length,results=Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var idx=array.length;for("number"==typeof from&&(idx=0>from?idx+from+1:Math.min(idx,from+1));--idx>=0;)if(array[idx]===item)return idx;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return _.isObject(result)?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=hasher?hasher.apply(this,arguments):key;return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}},_.once=_.partial(_.before,2),_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){if(!_.isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;length>i;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj},_.pick=function(obj,iteratee,context){var key,result={};if(null==obj)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;length>i;i++)key=keys[i],key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;length>i;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size,result;if("[object Array]"===className){if(size=a.length,result=size===b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{var key,keys=_.keys(a);if(size=keys.length,result=_.keys(b).length===size)for(;size--&&(key=keys[size],result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)););}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(null==obj)return!length;obj=new Object(obj);for(var i=0;length>i;i++){var pair=pairs[i],key=pair[0];
if(pair[1]!==obj[key]||!(key in obj))return!1}return!0}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}]},{},[14])(14)});